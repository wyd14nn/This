<!DOCTYPE html>
<html>
<head>
    <title>The Station - Chapter 1</title>
    <style>
        body, html { margin: 0; padding: 0; width: 100%; height: 100%; background: #000; overflow: hidden; }
        canvas { display: block; width: 100vw; height: 100vh; image-rendering: pixelated; }
        
        #overlay { 
            position: absolute; inset: 0; background: #000; color: white; 
            display: flex; justify-content: center; align-items: center; 
            font-family: 'Courier New', monospace; z-index: 10; cursor: pointer; 
        }

        #dialogue-box { 
            position: absolute; bottom: 8%; left: 50%; transform: translateX(-50%); 
            width: 70%; background: rgba(10, 10, 15, 0.85); 
            border-left: 4px solid #7aa2f7; padding: 20px; color: #a9b1d6; 
            font-family: 'Courier New', monospace; pointer-events: none; 
        }
    </style>
</head>
<body>

<div id="overlay" onclick="start()"><h1>CLICK TO BEGIN</h1></div>
<div id="dialogue-box"></div>
<canvas id="gameCanvas"></canvas>

<script>
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');
    const diagBox = document.getElementById('dialogue-box');

    function resize() {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
    }
    window.addEventListener('resize', resize);
    resize();

    // --- LOAD YOUR IMAGES ---
    const bg = new Image();
    bg.src = 'bg.png'; // <--- CHANGE THIS to your actual filename if it's not bg.png

    let gameStarted = false;
    let player = { x: 0, y: 0, w: 40, h: 80, speed: 6 };
    let keys = {};

    function start() {
        document.getElementById('overlay').style.opacity = "0";
        setTimeout(() => document.getElementById('overlay').style.display = "none", 1000);
        gameStarted = true;
        typeWriter("I shouldn't have come back. The air here tastes like memories.");
    }

    // Typewriter effect
    let targetText = ""; let currentText = ""; let charIndex = 0;
    function typeWriter(text) {
        if (targetText === text) return;
        targetText = text; currentText = ""; charIndex = 0;
        flow();
    }
    function flow() {
        if (charIndex < targetText.length) {
            currentText += targetText.charAt(charIndex);
            diagBox.innerHTML = currentText;
            charIndex++; setTimeout(flow, 40);
        }
    }

    window.addEventListener('keydown', e => keys[e.code] = true);
    window.addEventListener('keyup', e => keys[e.code] = false);

    function draw() {
        if (!gameStarted) { requestAnimationFrame(draw); return; }

        ctx.fillStyle = "#050508";
        ctx.fillRect(0, 0, canvas.width, canvas.height);

        // 1. Draw your "Stunning" Background
        if (bg.complete) {
            // This stretches the BG to fill the screen
            ctx.drawImage(bg, 0, 0, canvas.width, canvas.height);
        }

        // 2. Movement logic
        if (keys['ArrowRight']) player.x += player.speed;
        if (keys['ArrowLeft']) player.x -= player.speed;

        // 3. Draw Player Sprite (Silhouette)
        // This puts the player at the bottom of the screen
        let groundY = canvas.height * 0.82; 
        ctx.fillStyle = "rgba(0,0,0,0.85)";
        ctx.fillRect(canvas.width/2 - player.w/2, groundY - player.h, player.w, player.h);

        // 4. Interaction Triggers based on walking distance
        if (player.x > 800 && player.x < 1200) {
            typeWriter("The station clock is still broken. Just like when I left.");
        }

        // 5. Cinematic Rain
        ctx.strokeStyle = "rgba(255,255,255,0.15)";
        for(let i=0; i<25; i++) {
            let rx = Math.random() * canvas.width;
            let ry = Math.random() * canvas.height;
            ctx.beginPath(); ctx.moveTo(rx, ry); ctx.lineTo(rx-1, ry+12); ctx.stroke();
        }

        requestAnimationFrame(draw);
    }
    draw();
</script>
</body>
</html>
